Add restore finalizer to clean up external resources